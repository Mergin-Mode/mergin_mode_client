(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],{101:function(e,t,n){"use strict";n.r(t);var r=n(0),i=n.n(r),a=n(8),o=n.n(a),c=(n(84),n(85),n(86),n(50)),d=n(26),s=n(1),l=(n(91),n(62)),u=n(54),m=n(52);Math.PI;function p(e,t,n,r,i,a,o,c,d,p){o.FBXLoader=u.a,o.GLTFLoader=m.a;new s.h;var w=document.getElementById("three-map");n=new s.mb;var h=document.getElementsByTagName("video")[0],v=new s.Hb(h);v.minFilter=s.E,v.magFilter=s.E,v.format=s.jb,n.background=v,(r=new s.Ib({antialias:!0,alpha:!0})).setPixelRatio(window.devicePixelRatio),r.setClearColor(0,0),r.setSize(w.clientWidth,w.clientHeight),w.appendChild(r.domElement),(e=new s.ab(60,w.clientWidth/w.clientHeight,1,1e4)).position.set(50,17,50),(t=new l.a(e)).enableDamping=!0,t.dampingFactor=.05,t.screenSpacePanning=!1,t.minDistance=1,t.maxDistance=1e3,t.rotateSpeed=.8,t.panSpeed=.8,t.zoomSpeed=.8;var g=new s.bb(100,100,99,99);!function(e){for(var t=e.getAttribute("position"),n=t.array,r=2,i=0;r<n.length;r+=3,i++)n[r]=0;t.needsUpdate=!0,e.computeVertexNormals()}(g);var f=new s.R({wireframe:!0,color:"#222",side:s.l});f.flatShading=!0;var b=new s.O(g,f);b.position.set(0,0,0),b.castShadow=!1,b.receiveShadow=!1,b.geometry.rotateX(Math.PI/2),n.add(b);var E=new s.s(1e4,1e3);n.add(E);var y=new s.a(4210752,1);n.add(y);var _=new s.u(16777215,16777215,1);_.color.setHSL(.6,.5,.75),_.groundColor.setHSL(.095,.5,.5),_.position.set(0,0,50),n.add(_);var O=new s.k(16777215,1);window.dirLight=O,O.position.set(1,-1,1),O.position.multiplyScalar(50),O.name="dirlight",n.add(O),O.castShadow=!1,i=new s.O(new s.sb(.5,32,32),new s.P({color:"red"}));var j=new s.O(new s.sb(150,32,32),new s.P({opacity:0,transparent:!0,alphaTest:.05,side:s.l}));j.rotation.set(Math.PI/2,0,0),n.add(j);var S=new s.kb,T=new s.Cb;function D(t){var r;window.mergin_mode.selected.object&&(window.mergin_mode.selected.object.traverse((function(e){e.isMesh&&(e.material=window.mergin_mode.selected.material[e.uuid])})),window.mergin_mode.selected.object=null,window.mergin_mode.selected.material=null),T.x=(t.clientX||t.changedTouches[0].clientX)/window.innerWidth*2-1,T.y=-(t.clientY||t.changedTouches[0].clientY)/window.innerHeight*2+1,S.setFromCamera(T,e);var i=function e(t){return!(!t||!window.mergin_mode.world)&&(-1!==window.mergin_mode.world.map((function(e){return e.id})).indexOf(t.uuid)?t:e(t.parent))}(null===(r=(S.intersectObjects(n.children,!0)||[])[0])||void 0===r?void 0:r.object);if(!i)return p(null),!1;var a=new s.R({color:"#b34f0b",side:s.l});window.mergin_mode.selected.object=i,window.mergin_mode.selected.material={},i.traverse((function(e){e.isMesh&&(window.mergin_mode.selected.material[e.uuid]=e.material,e.material=a)})),p(i.uuid)}function x(){e.aspect=w.clientWidth/w.clientHeight,e.updateProjectionMatrix(),r.setSize(w.clientWidth,w.clientHeight)}return function i(){setTimeout((function(){var a;requestAnimationFrame(i),!1!==(null===(a=window.mergin_mode.scene)||void 0===a?void 0:a.visible)&&(t.update(),r.render(n,e))}),60)}(),window.addEventListener("resize",x,!1),document.getElementById("three-map").addEventListener("click",D,!1),document.getElementById("three-map").addEventListener("touchend",D,!1),{plane:b,camera:e,controls:t,scene:n,renderer:r,pointer:i,partials:{plane:b,pointer:i,sky:j,gridHelper:E},loaders:o,onWindowResize:x}}m.a.prototype.load2=function(e,t){var n=this,r=e[0],i=new FileReader;i.onload=function(e){2!==e.target.readyState&&0!==e.target.status||n.parse(e.target.result||e.target.responseText,"",t)},i.readAsArrayBuffer(r)},u.a.prototype.load2=function(e,t){var n=this,r=e[0],i=new FileReader;i.onload=function(e){if(2===e.target.readyState||0===e.target.status){var r=n.parse(e.target.result||e.target.responseText);t&&t(r)}},i.readAsArrayBuffer(r)};var w=Object(d.b)((function(e){return{api:e.api}}),(function(e){return{setDescriptiveData:function(t){return e({type:"SET_DESCRIPTIVE_DATA",descriptiveData:t})}}}))((function(e){return Object(r.useEffect)((function(){var t;if(!(null===(t=navigator.mediaDevices)||void 0===t?void 0:t.getUserMedia))return!1;navigator.mediaDevices.getUserMedia({video:{width:1280,height:720,facingMode:"environment"}}).then((function(e){var t=document.getElementById("video");t.srcObject=e,t.play()}));var n=window.mergin_mode,r=(n.mixers,n.camera),i=n.controls,a=n.scene,o=n.renderer,d=n.pointer,s=(n.partials,n.loaders),l=(document.getElementById("three-map"),p(r,i,a,o,d,0,s,0,0,(function(t){var n=t?window.mergin_mode.world.filter((function(e){return e.id==t}))[0].description:null;e.setDescriptiveData(n)})));window.mergin_mode=Object(c.a)(Object(c.a)({},window.mergin_mode),l),e.context()}),[]),i.a.createElement("div",{id:"world"},i.a.createElement("video",{id:"video",style:{display:"none"},autoPlay:!0,playsInline:!0}),i.a.createElement("div",{id:"three-map",style:{position:"absolute",width:"100%",height:"100%"}}))})),h=(n(92),n(23)),v=n(4),g=n(129),f=n(139),b=n(137),E=n(135),y=n(138),_=function(e){var t=Object(g.a)((function(e){return{root:Object(v.a)({pointerEvents:"none",height:380,transform:"translateZ(0px)",flexGrow:1,flex:1,zIndex:10,width:"100%"},"height","100%"),speedDial:{position:"absolute",bottom:e.spacing(2),right:e.spacing(2),"& .MuiButtonBase-root.MuiFab-root.MuiSpeedDial-fab.MuiFab-primary":{width:48,height:48}}}}))(),n=i.a.useState(!1),r=Object(h.a)(n,2),a=r[0],o=r[1],c=function(){o(!1)};return i.a.createElement("div",{className:t.root},i.a.createElement(f.a,{open:a}),i.a.createElement(b.a,{ariaLabel:"Action Tooltip",className:t.speedDial,icon:i.a.createElement(y.a,null),onClose:c,onOpen:function(){o(!0)},open:a},e.actions.map((function(e){return i.a.createElement(E.a,{key:e.name,icon:e.icon,tooltipTitle:e.name,tooltipOpen:!0,onClick:c})}))))};n(134);Object(g.a)((function(e){return{paper:{position:"absolute",width:400,backgroundColor:e.palette.background.paper,border:"2px solid #000",boxShadow:e.shadows[5],padding:e.spacing(2,4,3)}}})),n(97);var O=n(67),j=n.n(O),S=n(65),T=n.n(S),D=n(66),x=n.n(D),L=Object(d.b)((function(e){return{descriptiveData:e.api.descriptiveData}}),(function(e){return{}}))((function(e){var t=Object(r.useRef)(),n=Object(r.useRef)(),a=Object(r.useRef)({height:null,movementY:null,previousTouchY:null}),o=function(){a.current={height:null,movementY:null,previousTouchY:null};var e=function(e){"undefined"===typeof e.movementY?(a.current.movementY=e.touches[0].pageY-(a.current.previousTouchY||e.touches[0].pageY),a.current.previousTouchY=e.touches[0].pageY):a.current.movementY=e.movementY,a.current.height=n.current.offsetHeight-a.current.movementY,n.current.style.height="".concat(a.current.height,"px")};t.current.style.height="100%",window.addEventListener("mousemove",e),window.addEventListener("touchmove",e);var r=function(){a.current.height<200&&(n.current.classList.add("transition"),a.current.movementY>0?a.current.height=0:a.current.movementY<0&&(a.current.height=200)),n.current.style.height="".concat(a.current.height,"px"),setTimeout((function(){n.current.classList.remove("transition")}),500),window.removeEventListener("mousemove",e),window.removeEventListener("touchmove",e),t.current.style.height="38px"};window.addEventListener("mouseup",r),window.addEventListener("touchend",r)};return i.a.createElement("div",{id:"controls"},i.a.createElement("img",{id:"logo",width:120,height:87.9375,src:"/logo-transparent.png"}),i.a.createElement("div",{id:"actions-menu"},i.a.createElement(_,{actions:[{icon:i.a.createElement(T.a,{color:"secondary"}),name:"Immerse"},{icon:i.a.createElement(x.a,{color:"secondary"}),name:"QR Scan"},{icon:i.a.createElement(j.a,{color:"secondary"}),name:"Full Screen"}]}),i.a.createElement("div",{id:"descriptive-data-container",ref:function(e){return n.current=e}},i.a.createElement("div",{id:"slider-helper",onMouseDown:o,onTouchStart:o,ref:function(e){return t.current=e}}),i.a.createElement("div",{id:"slider"}),i.a.createElement("div",{id:"descriptive-data",dangerouslySetInnerHTML:{__html:e.descriptiveData}}))))})),k=n(53),I=n.n(k),Y=n(68),P=n(47),R=n(55),M=n(69),A=function(e,t){var n=e[0],r=(n.name,n.size,n.url),i=window.mergin_mode,a=i.scene,o=new i.loaders.GLTFLoader,c=new M.a;return o.setDRACOLoader(c),new Promise((function(e,n){o.load(r,(function(n){var r;(r=n.scene.position).set.apply(r,Object(R.a)(t)),a.add(n.scene),e(n.scene.uuid)}))}))},B=function(e,t){var n=e[0],r=(n.name,n.size,n.url),i=window.mergin_mode,a=i.scene,o=new i.loaders.FBXLoader;return new Promise((function(e,n){o.load(r,(function(n){var r;n.traverse((function(e){e.isMesh&&(e.castShadow=!0,e.receiveShadow=!0)})),(r=n.position).set.apply(r,Object(R.a)(t)),a.add(n),e(n.uuid)}))}))},F=Object(Y.a)(I.a.mark((function e(){var t,n,r,i;return I.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Object(P.a)([40.626374,22.948324,15.25]),Object(P.a)([40.62626,22.947929,15.25]),Object(P.a)([40.626288,22.947957,15.25]),t=[0,0,0],n=[0,0,20],e.next=7,B([{url:"/tree-green.fbx"}],n);case 7:return r=e.sent,e.next=10,A([{url:"/white-tower.gltf"}],t);case 10:i=e.sent,window.mergin_mode.world=[{id:i,description:'<iframe \n          style="\n            width: 100%;\n            height: 100%;\n            border:none;"\n          src="https://en.wikipedia.org/wiki/White_Tower_of_Thessaloniki"></iframe>'},{id:r,description:'<iframe \n          style="\n            width: 100%;\n            height: 100%;\n            border:none;"\n          src="https://en.wikipedia.org/wiki/Tree"></iframe>'}];case 12:case"end":return e.stop()}}),e)}))),C=n(72),H=n(133),W=Object(C.a)({palette:{primary:{main:"#b34f0b"},secondary:{main:"#323228"}}});var z=function(){return i.a.createElement(H.a,{theme:W},i.a.createElement("div",{className:"App"},i.a.createElement(w,{context:F}),i.a.createElement(L,null)))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var N=n(21),X=n(70),U=n(71),V={currentAction:"immerse",descriptiveData:null},G=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:V,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_DESCRIPTIVE_DATA":var n=t.descriptiveData;return Object.assign({},e,{descriptiveData:n});default:return e}};window.mergin_mode={modelLayer:[],vectors:[],plane:{},sky:{},mixers:[],camera:{},controls:{},scene:{},renderer:{},pointer:{},partials:{},loaders:{},selected:{object:null,material:null},onWindowResize:function(){}};var J=Object(N.c)({api:G}),q=document.getElementById("root"),Q=Object(X.createLogger)({}),Z=Object(N.d)(J,window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__(),Object(N.a)(U.a,Q));o.a.render(i.a.createElement(d.a,{store:Z},i.a.createElement(z,null)),q),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},79:function(e,t,n){e.exports=n(101)},84:function(e,t,n){},86:function(e,t,n){},97:function(e,t,n){"use strict";(function(e){n(23),n(0),n(104),e.browser&&/iPad|iPhone|iPod/.test(navigator.userAgent)}).call(this,n(98))}},[[79,1,2]]]);
//# sourceMappingURL=main.9ebabe39.chunk.js.map
(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],{71:function(e,t,n){e.exports=n(90)},76:function(e,t,n){},77:function(e,t,n){},90:function(e,t,n){"use strict";n.r(t);var a=n(1),o=n.n(a),i=n(8),r=n.n(i),c=(n(76),n(45)),d=n(16),s=(n(77),n(0)),l=(n(78),n(56)),m=n(48),u=n(46);Math.PI;function p(e,t,n,a,o,i,r,c,d,p){r.FBXLoader=m.a,r.GLTFLoader=u.a;new s.h;var w=document.getElementById("three-map");n=new s.mb;var g=document.getElementsByTagName("video")[0],f=new s.Hb(g);f.minFilter=s.E,f.magFilter=s.E,f.format=s.jb,n.background=f,(a=new s.Ib({antialias:!0,alpha:!0})).setPixelRatio(window.devicePixelRatio),a.setClearColor(0,0),a.setSize(w.clientWidth,w.clientHeight),w.appendChild(a.domElement),(e=new s.ab(60,w.clientWidth/w.clientHeight,1,1e4)).position.set(50,17,50),(t=new l.a(e)).enableDamping=!0,t.dampingFactor=.05,t.screenSpacePanning=!1,t.minDistance=1,t.maxDistance=1e3,t.rotateSpeed=.8,t.panSpeed=.8,t.zoomSpeed=.8;var h=new s.bb(100,100,99,99);!function(e){for(var t=e.getAttribute("position"),n=t.array,a=2,o=0;a<n.length;a+=3,o++)n[a]=0;t.needsUpdate=!0,e.computeVertexNormals()}(h);var v=new s.R({wireframe:!0,color:"#222",side:s.l});v.flatShading=!0;var b=new s.O(h,v);b.position.set(0,0,0),b.castShadow=!1,b.receiveShadow=!1,b.geometry.rotateX(Math.PI/2),n.add(b);var y=new s.s(1e4,1e3);n.add(y);var E=new s.a(4210752,1);n.add(E);var O=new s.u(16777215,16777215,1);O.color.setHSL(.6,.5,.75),O.groundColor.setHSL(.095,.5,.5),O.position.set(0,0,50),n.add(O);var j=new s.k(16777215,1);window.dirLight=j,j.position.set(1,-1,1),j.position.multiplyScalar(50),j.name="dirlight",n.add(j),j.castShadow=!1,o=new s.O(new s.sb(.5,32,32),new s.P({color:"red"}));var S=new s.O(new s.sb(150,32,32),new s.P({opacity:0,transparent:!0,alphaTest:.05,side:s.l}));S.rotation.set(Math.PI/2,0,0),n.add(S);var x=new s.kb,_=new s.Cb;function k(t){var a;window.mergin_mode.selected.object&&(window.mergin_mode.selected.object.traverse((function(e){e.isMesh&&(e.material=window.mergin_mode.selected.material[e.uuid])})),window.mergin_mode.selected.object=null,window.mergin_mode.selected.material=null),_.x=(t.clientX||t.changedTouches[0].clientX)/window.innerWidth*2-1,_.y=-(t.clientY||t.changedTouches[0].clientY)/window.innerHeight*2+1,x.setFromCamera(_,e);var o=function e(t){return!(!t||!window.mergin_mode.world)&&(-1!==window.mergin_mode.world.map((function(e){return e.id})).indexOf(t.uuid)?t:e(t.parent))}(null===(a=(x.intersectObjects(n.children,!0)||[])[0])||void 0===a?void 0:a.object);if(!o)return!1;var i=new s.R({color:"#b34f0b",side:s.l});window.mergin_mode.selected.object=o,window.mergin_mode.selected.material={},o.traverse((function(e){e.isMesh&&(window.mergin_mode.selected.material[e.uuid]=e.material,e.material=i)})),p(o.uuid)}function C(){e.aspect=w.clientWidth/w.clientHeight,e.updateProjectionMatrix(),a.setSize(w.clientWidth,w.clientHeight)}return function o(){setTimeout((function(){var i;requestAnimationFrame(o),!1!==(null===(i=window.mergin_mode.scene)||void 0===i?void 0:i.visible)&&(t.update(),a.render(n,e))}),60)}(),window.addEventListener("resize",C,!1),document.getElementById("three-map").addEventListener("click",k,!1),document.getElementById("three-map").addEventListener("touchend",k,!1),{plane:b,camera:e,controls:t,scene:n,renderer:a,pointer:o,partials:{plane:b,pointer:o,sky:S,gridHelper:y},loaders:r,onWindowResize:C}}u.a.prototype.load2=function(e,t){var n=this,a=e[0],o=new FileReader;o.onload=function(e){2!==e.target.readyState&&0!==e.target.status||n.parse(e.target.result||e.target.responseText,"",t)},o.readAsArrayBuffer(a)},m.a.prototype.load2=function(e,t){var n=this,a=e[0],o=new FileReader;o.onload=function(e){if(2===e.target.readyState||0===e.target.status){var a=n.parse(e.target.result||e.target.responseText);t&&t(a)}},o.readAsArrayBuffer(a)};var w=n(57),g=n.n(w),f=n(4),h=n(120),v=n(130),b=n(129),y=n(126),E=n(128),O=function(e){var t=Object(h.a)((function(e){return{root:Object(f.a)({pointerEvents:"none",height:380,transform:"translateZ(0px)",flexGrow:1,position:"absolute",zIndex:10,width:"100%"},"height","100%"),speedDial:{position:"absolute",bottom:e.spacing(2),right:e.spacing(2)}}}))(),n=o.a.useState(!1),a=Object(d.a)(n,2),i=a[0],r=a[1],c=function(){r(!1)};return o.a.createElement("div",{className:t.root},o.a.createElement(v.a,{open:i}),o.a.createElement(b.a,{ariaLabel:"Action Tooltip",className:t.speedDial,icon:o.a.createElement(E.a,null),onClose:c,onOpen:function(){r(!0)},open:i},e.actions.map((function(e){return o.a.createElement(y.a,{key:e.name,icon:e.icon,tooltipTitle:e.name,tooltipOpen:!0,onClick:c})}))))},j=n(125);function S(){return Math.round(20*Math.random())-10}function x(){var e=50+S(),t=50+S();return{maxWidth:"50%",width:"50%",top:"".concat(e,"%"),left:"".concat(t,"%"),transform:"translate(-".concat(e,"%, -").concat(t,"%)")}}var _=Object(h.a)((function(e){return{paper:{position:"absolute",width:400,backgroundColor:e.palette.background.paper,border:"2px solid #000",boxShadow:e.shadows[5],padding:e.spacing(2,4,3)}}})),k=function(e){var t=_(),n=o.a.useState(x),a=Object(d.a)(n,1)[0],i=o.a.useState(!1),r=Object(d.a)(i,2),c=(r[0],r[1],o.a.createElement("div",{style:a,className:t.paper},o.a.createElement("h2",{id:"simple-modal-title"},"Text in a modal"),o.a.createElement("p",{id:"simple-modal-description"},e.data)));return o.a.createElement(j.a,{open:!0,onClose:e.onClose,"aria-labelledby":"simple-modal-title","aria-describedby":"simple-modal-description"},c)},C=n(66),L=n(124),P=n(65),F=n.n(P),I=n(64),M=n.n(I),R=n(63),T=n.n(R),B=n(47),z=n.n(B),W=n(61),A=n(42),H=n(49),D=n(62),N=function(e,t){var n=e[0],a=(n.name,n.size,n.url),o=window.mergin_mode,i=o.scene,r=new o.loaders.GLTFLoader,c=new D.a;return r.setDRACOLoader(c),new Promise((function(e,n){r.load(a,(function(n){var a;(a=n.scene.position).set.apply(a,Object(H.a)(t)),i.add(n.scene),e(n.scene.uuid)}))}))},X=function(e,t){var n=e[0],a=(n.name,n.size,n.url),o=window.mergin_mode,i=o.scene,r=new o.loaders.FBXLoader;return new Promise((function(e,n){r.load(a,(function(n){var a;n.traverse((function(e){e.isMesh&&(e.castShadow=!0,e.receiveShadow=!0)})),(a=n.position).set.apply(a,Object(H.a)(t)),i.add(n),e(n.uuid)}))}))},U=Object(W.a)(z.a.mark((function e(){var t,n,a,o;return z.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Object(A.a)([40.626374,22.948324,15.25]),Object(A.a)([40.62626,22.947929,15.25]),Object(A.a)([40.626288,22.947957,15.25]),t=[0,0,0],n=[0,0,20],e.next=7,X([{url:"/tree-green.fbx"}],n);case 7:return a=e.sent,e.next=10,N([{url:"/white-tower.gltf"}],t);case 10:o=e.sent,console.log(a,o),window.mergin_mode.world=[{id:a,description:"This is the model 1"},{id:o,description:"This is the model 2"}];case 13:case"end":return e.stop()}}),e)}))),G=Object(C.a)({palette:{primary:{main:"#b34f0b"},secondary:{main:"#323228"}}});window.mergin_mode={modelLayer:[],vectors:[],plane:{},sky:{},mixers:[],camera:{},controls:{},scene:{},renderer:{},pointer:{},partials:{},loaders:{},selected:{object:null,material:null},onWindowResize:function(){}};var J=function(){var e=Object(a.useState)({latitude:0,longitude:0}),t=Object(d.a)(e,2),n=t[0],i=t[1],r=Object(a.useState)("immerse"),s=Object(d.a)(r,2),l=s[0],m=s[1],u=Object(a.useState)(null),w=Object(d.a)(u,2),f=w[0],h=w[1],v=Object(a.useRef)(null),b=Object(a.useRef)(null),y=Object(a.useRef)(n);return Object(a.useRef)({}),Object(a.useEffect)((function(){var e,t;if(!(null===(e=navigator.geolocation)||void 0===e?void 0:e.getCurrentPosition)||!(null===(t=navigator.mediaDevices)||void 0===t?void 0:t.getUserMedia))return!1;navigator.geolocation.getCurrentPosition((function(e){var t=e.coords.latitude,n=e.coords.longitude;y.current={latitude:t,longitude:n},i(y.current)}),(function(){})),navigator.mediaDevices.getUserMedia({video:{width:1280,height:720,facingMode:"environment"}}).then((function(e){var t=document.getElementById("video");t.srcObject=e,t.play()}));var n=window.mergin_mode,a=(n.mixers,n.camera),o=n.controls,r=n.scene,d=n.renderer,s=n.pointer,l=(n.partials,n.loaders),m=(document.getElementById("three-map"),p(a,o,r,d,s,0,l,0,0,(function(e){return h(window.mergin_mode.world.filter((function(t){return t.id==e}))[0].description)})));window.mergin_mode=Object(c.a)(Object(c.a)({},window.mergin_mode),m),U()}),[]),Object(a.useEffect)((function(){var e="immerse"===l;window.mergin_mode.scene.visible=e,window.mergin_mode.scene.needsUpdate=!0,v.current.style.display=e?"block":"none"}),[l]),o.a.createElement(L.a,{theme:G},o.a.createElement("div",{className:"App",ref:function(e){return b.current=e}},o.a.createElement("div",{id:"main",ref:function(e){return v.current=e}},o.a.createElement("img",{id:"logo",width:120,height:87.9375,src:"/logo-transparent.png"}),o.a.createElement("video",{id:"video",style:{display:"none"},autoPlay:!0,playsInline:!0}),o.a.createElement("div",{id:"three-map",style:{position:"absolute",width:"100%",height:"100%"}})),o.a.createElement(O,{actions:[{icon:o.a.createElement(T.a,{color:"secondary",onClick:function(){return m("immerse")}}),name:"Immerse"},{icon:o.a.createElement(M.a,{color:"secondary",onClick:function(){return m("scan")}}),name:"QR Scan"},{icon:o.a.createElement(F.a,{color:"secondary",onClick:function(){document.fullscreenElement?document.exitFullscreen():b.current.requestFullscreen().catch((function(e){f("Error attempting to enable full-screen mode: ".concat(e.message," (").concat(e.name,")"))}))}}),name:"Full Screen"}]}),"scan"===l&&o.a.createElement("div",{className:"scan-tip"},o.a.createElement(g.a,{delay:300,onError:function(e){console.error(e)},onScan:function(e){if(e){var t=JSON.parse(e);window.mergin_mode.camera.position.set(t.x,t.y,t.z),m("immerse"),window.mergin_mode.controls.alphaOffset=t.heading/180*Math.PI,window.mergin_mode.controls.update()}},style:{width:"100%"}})),f&&o.a.createElement(k,{data:f,onClose:function(){h(null),m("immerse")}})))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(J,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[71,1,2]]]);
//# sourceMappingURL=main.16c27a07.chunk.js.map